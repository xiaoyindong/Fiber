{"version":3,"sources":["webpack://fiber/./src/react/Component/index.js","webpack://fiber/./src/react/CreateElement/index.js","webpack://fiber/./src/react/DOM/createDOMElement.js","webpack://fiber/./src/react/DOM/index.js","webpack://fiber/./src/react/DOM/updateNodeElement.js","webpack://fiber/./src/react/Misc/Arrified/index.js","webpack://fiber/./src/react/Misc/CreateTaskQueue/index.js","webpack://fiber/./src/react/Misc/createReactInstance/index.js","webpack://fiber/./src/react/Misc/createStateNode/index.js","webpack://fiber/./src/react/Misc/getTag/index.js","webpack://fiber/./src/react/Misc/index.js","webpack://fiber/./src/react/index.js","webpack://fiber/./src/react/reconciliation/index.js","webpack://fiber/webpack/bootstrap","webpack://fiber/webpack/runtime/define property getters","webpack://fiber/webpack/runtime/hasOwnProperty shorthand","webpack://fiber/webpack/runtime/make namespace object","webpack://fiber/./src/index.js"],"names":["Component","props","createElement","type","children","childElements","concat","reduce","result","child","Object","push","textContent","assign","createDOMElement","virtualDOM","newElement","document","createTextNode","updateNodeElement","oldVirtualDOM","newProps","oldProps","keys","forEach","propName","newPropsValue","oldPropsValue","startsWith","eventName","toLowerCase","slice","addEventListener","removeEventListener","setAttribute","removeAttribute","arrified","arg","Array","isArray","createTaskQueue","taskQueue","item","pop","shift","isEmpty","length","createReactInstance","fiber","instance","tag","createStateNode","getTag","vdom","getPrototypeOf","subTask","pendingCommit","commitAllWork","effects","effectTag","parentFiber","parent","stateNode","appendChild","getFirstTask","task","dom","reconcileChildren","arrifiedChildren","index","numberOfElements","element","newFiber","prevFiber","sibling","executeTask","render","currentExecutelyFiber","workLoop","deadline","timeRemaining","performTask","requestIdleCallback","jsx","root","getElementById","Demo"],"mappings":"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","file":"bundle.js","sourcesContent":["export class Component {\n    constructor(props) {\n        this.props = props;\n    }\n}","export default function createElement(type, props, ...children) {\n    // 遍历children对象\n    const childElements = [].concat(...children).reduce((result, child) => {\n      // 判断child不能是布尔也不能是null\n      // 因为使用reduce，所以result是前一次循环的返回值，最终返回result就可以\n      if (child !== false && child !== true && child !== null) {\n        if (child instanceof Object) {\n          result.push(child); // 是对象直接返回\n        } else {\n          // 不是对象 调用createElement方法生成一个对象\n          result.push(createElement('text', {\n            textContent: child\n          }));\n        }\n      }\n      return result;\n    }, [])\n    return {\n      type,\n      props: Object.assign({ children: childElements}, props)\n    }\n  }\n  ","import updateNodeElement from \"./updateNodeElement\";\n\nexport default function createDOMElement(virtualDOM) {\n    let newElement = null;\n    if (virtualDOM.type === 'text') {\n        // 文本节点 使用createTextNode创建\n        newElement = document.createTextNode(virtualDOM.props.textContent);\n    } else {\n        // 元素节点 使用 createElement 创建\n        newElement = document.createElement(virtualDOM.type);\n        updateNodeElement(newElement, virtualDOM);\n    }\n    return newElement;\n}","export { default as createDOMElement } from './createDOMElement';\nexport { default as updateNodeElement } from './updateNodeElement';","export default function updateNodeElement(newElement, virtualDOM, oldVirtualDOM = {}) {\n    // 获取节点对应的属性对象\n    const newProps = virtualDOM.props || {};\n    // 获取旧的属性对象\n    const oldProps = oldVirtualDOM.props || {};\n    Object.keys(newProps).forEach(propName => {\n        // 新的属性值\n        const newPropsValue = newProps[propName];\n        // 旧的属性值\n        const oldPropsValue = oldProps[propName];\n        // 对比是否相同\n        if (newPropsValue !== oldPropsValue) {\n            // 判断是否是事件属性\n            if (propName.startsWith('on')) {\n                // 截取出事件名称\n                const eventName = propName.toLowerCase().slice(2);\n                // 为元素添加事件\n                newElement.addEventListener(eventName, newPropsValue);\n                // 如果存在原有事件，需要删除掉。\n                if (oldPropsValue) {\n                    newElement.removeEventListener(eventName, oldPropsValue);\n                }\n            } else if (propName === 'value' || propName === 'checked') {\n                // 如果属性名是value或者checked不能使用setAttribute来设置，直接以属性方式设置即可\n                newElement[propName] = newPropsValue;\n            } else if (propName !== 'children') {\n                // 排除children\n                if (propName === 'className') {\n                    newElement.setAttribute('class', newPropsValue)\n                } else {\n                    newElement.setAttribute(propName, newPropsValue)\n                }\n            }\n        }\n    })\n    // 判断属性被删除的情况\n    Object.keys(oldProps).forEach(propName => {\n        // 新的属性值\n        const newPropsValue = newProps[propName];\n        // 旧的属性值\n        const oldPropsValue = oldProps[propName];\n        if (!newPropsValue) {\n            // 判断是否是事件属性\n            if (propName.startsWith('on')) {\n                 // 截取出事件名称\n                 const eventName = propName.toLowerCase().slice(2);\n                 // 删除事件\n                 newElement.removeEventListener(eventName, oldPropsValue);\n            } else if (propName !== 'children') {\n                newElement.removeAttribute(propName);\n            }\n        }\n    })\n}","const arrified = arg => Array.isArray(arg) ? arg : [arg]\n\nexport default arrified;","const createTaskQueue = () => {\n    const taskQueue = [];\n    return {\n        push: item => { // 向任务队列中添加任务\n            return taskQueue.push(item);\n        },\n        pop: () => { // 从任务队列中获取任务\n            return taskQueue.shift();\n        },\n        isEmpty: () => { // 判断是否存在任务\n            taskQueue.length === 0\n        }\n    }\n}\n\nexport default createTaskQueue;","export const createReactInstance = fiber => {\n    let instance = null;\n    \n    if (fiber.tag === 'class_component') {\n        instance = new fiber.type(fiber.props)\n    } else {\n        instance = fiber.type;\n    }\n    return instance;\n}","import { createDOMElement } from '../../DOM'\nimport { createReactInstance } from '../createReactInstance';\n\nconst createStateNode = fiber => {\n    // 普通节点\n    if (fiber.tag === 'host_component') {\n        return createDOMElement(fiber)\n    } else {\n        // 组件\n        return createReactInstance(fiber)\n    }\n}\n\nexport default createStateNode;","import { Component } from '../../Component';\nconst getTag = vdom => {\n    // 如果是普通节点\n    if (typeof vdom.type === 'string') {\n        return 'host_component'\n    } else if (Object.getPrototypeOf(vdom.type) === Component) {\n        // 如果是类组件\n        return 'class_component'\n    } else {\n        // 函数组件\n        return 'function_component'\n    }\n}\n\nexport default getTag;","export { default as createTaskQueue } from './CreateTaskQueue';\nexport { default as arrified } from './Arrified';\nexport { default as createStateNode } from './createStateNode';\nexport { default as getTag } from './getTag';\n","import createElement from './CreateElement';\n\nexport { render } from './reconciliation'\n\nexport { Component } from './Component';\n\nexport default {\n    createElement,\n}","import {\n    createTaskQueue,\n    arrified,\n    createStateNode,\n    getTag\n} from '../Misc';\n\nconst taskQueue = createTaskQueue();\n\nlet subTask = null;\n\nlet pendingCommit = null;\n\nconst commitAllWork = fiber => {\n    fiber.effects.forEach(item => {\n        // 追加节点\n        if (item.effectTag === 'placement') {\n            let fiber = item;\n            let parentFiber = item.parent\n            while (parentFiber.tag === 'class_component') {\n                parentFiber = parentFiber.parent;\n            }\n            if (fiber.tag === 'host_component') {\n                parentFiber.stateNode.appendChild(fiber.stateNode);\n            }\n        }\n    })\n}\n\nconst getFirstTask = () => {\n    // 从任务队列中获取任务\n    const task = taskQueue.pop();\n    // 返回最外层节点Fiber对象\n    return {\n        props: task.props,\n        stateNode: task.dom,\n        tag: 'host_root',\n        effects: [],\n        child: null,\n    }\n}\n\nconst reconcileChildren = (fiber, children) => {\n    // 将children转换成数组\n    const arrifiedChildren = arrified(children);\n\n    let index = 0;\n\n    let numberOfElements = arrifiedChildren.length;\n\n    let element = null;\n    // 当前正在构建的的Fiber\n    let newFiber = null;\n    // 存储前一个节点，用于构建兄弟关系\n    let prevFiber = null;\n    while (index < numberOfElements) {\n\n        element = arrifiedChildren[index];\n        // 子级fiber\n        newFiber = {\n            type: element.type,\n            props: element.props,\n            tag: getTag(element),\n            effects: [],\n            effectTag: 'placement', // 新增\n            stateNode: null, // dom对象，暂时没有\n            parent: fiber,\n        }\n        // 获取节点对象\n        newFiber.stateNode = createStateNode(newFiber);\n        // 如果第一个子节点就赋值到fiber上\n        if (index == 0) {\n            fiber.child = newFiber;\n        } else {\n            // 否则放在前一个的兄弟节点上\n            prevFiber.sibling = newFiber;\n        }\n        prevFiber = newFiber;\n        index++;\n    }\n}\n\nconst executeTask = fiber => {\n    // 构建子级fiber对象\n    if (fiber.tag === 'class_component') {\n        reconcileChildren(fiber, fiber.stateNode.render())\n    } else {\n        reconcileChildren(fiber, fiber.props.children)\n    }\n    // 有子级返回子级\n    if (fiber.child) {\n        return fiber.child\n    }\n    // 存储当前正在处理的对象\n    let currentExecutelyFiber = fiber;\n\n    while (currentExecutelyFiber.parent) {\n        currentExecutelyFiber.parent.effects = currentExecutelyFiber.parent.effects.concat(currentExecutelyFiber.effects.concat(currentExecutelyFiber))\n        // 有同级返回同级\n        if (currentExecutelyFiber.sibling) {\n            return currentExecutelyFiber.sibling\n        }\n        // 没有同级将父级给到循环，循环检查父级\n        currentExecutelyFiber = currentExecutelyFiber.parent\n    }\n    pendingCommit = currentExecutelyFiber;\n}\n\nconst workLoop = deadline => {\n    // 如果子任务不存在获取一个任务\n    if (!subTask) {\n        subTask = getFirstTask()\n    }\n    // 任务存在并且浏览器空余时间大于1ms执行任务\n    while (subTask && deadline.timeRemaining() > 1) {\n        subTask = executeTask(subTask);\n    }\n    // 执行第二阶段\n    if (pendingCommit) {\n        commitAllWork(pendingCommit)\n    }\n}\n\nconst performTask = deadline => {\n    workLoop(deadline);\n    // 判断任务是否存在，判断队列中是否有任务没有执行\n    if (subTask || !taskQueue.isEmpty()) {\n        requestIdleCallback(performTask)\n    }\n}\n\nexport const render = (element, dom) => {\n    // 1. 向任务队列中添加任务\n    taskQueue.push({\n        dom, // 父级\n        props: {\n            children: element // 子级\n        }\n    })\n    // 2. 指定在浏览器空闲时执行任务\n    requestIdleCallback(performTask)\n}","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import React, { render, Component } from './react';\nconst jsx = <div>\n    <p>Hello Fiber</p>\n    <p>Hi Fiber</p>\n</div>\n\nconst root = document.getElementById('root');\n\n// render(jsx, root)\n\nclass Demo extends Component {\n    constructor(props) {\n        super(props);\n    }\n\n    render() {\n        return <div>yindong</div>\n    }\n}\n\nrender(<Demo />, root)"],"sourceRoot":""}